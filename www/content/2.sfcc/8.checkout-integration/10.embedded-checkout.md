---
title: Embedded Checkout
description: Enable shoppers to  to complete their purchases directly within the retailer’s storefront 
icon: 'lucide:shopping-basket'
toc: false
---

## Overview

The Embedded Checkout feature enables shoppers to complete their purchases directly within the retailer’s storefront through an iFrame provided by ESW.

This approach improves the shopping experience by:

- Keeping the entire checkout process on the retailer’s site

- Enhancing shopper trust and confidence

- Reducing the need for redirects to external checkout pages


### Impacted Architectures

- **SFRA** (Salesforce Reference Architecture)

- **SG** (SiteGenesis)

- **PWA** (Progressive Web App)

---

### Order Flow with Embedded Checkout

#### When Embedded Checkout (EC) is enabled:

- An order is only created in SFCC once it has been confirmed by ESW.

- This confirmation is sent via an Order Confirmation Webhook from ESW to SFCC.

#### When Embedded Checkout is not enabled:

- The order is placed in SFCC immediately after the shopper clicks the Checkout button on the storefront.

::card
---
img: /flow.png
---
::

## Enable iFrame on ESP with Light Touch Integration (LTI)

To activate the Embedded Checkout iFrame, you need to configure it via **Light Touch Integration (LTI)**.

1. LTI provides the JavaScript snippet required to:

- Load the iFrame seamlessly within the retailer’s storefront.

2. Handle all shopper actions performed inside the iFrame, including:

- Navigating back to the cart

- Placing an order.

- Managing other checkout interactions

## Add Embedded Checkout Script via ESP

Follow these steps to configure the Embedded Checkout iFrame using Light Touch Integration (LTI) <br>

<div>
  <script async src="https://js.storylane.io/js/v2/storylane.js"></script>
  <div class="sl-embed" style="position:relative;padding-bottom:calc(50.59% + 25px);width:100%;height:0;transform:scale(1)">
    <iframe loading="lazy" class="sl-demo" src="https://demo.esw.com/demo/cpiokf33wsdf?embed=inline" name="sl-embed" allow="fullscreen" allowfullscreen style="position:absolute;top:0;left:0;width:100%!important;height:100%!important;border:1px solid rgba(63,95,172,0.35);box-shadow: 0px 0px 18px rgba(26, 19, 72, 0.15);border-radius:10px;box-sizing:border-box;"></iframe>
  </div>
</div>

::steps{:level="4"}

#### :smart-icon{name="streamline-ultimate-color:e-commerce-apparel" size=45} Access Storefront Integration Settings  

- In the **ESP Panel**.
- Navigate to: **Settings → Storefront Integration**

#### :smart-icon{name="streamline-ultimate-color:browser-page-media" size=45} Create a New Slot  

- Click the ``+ New Slot`` button.
- In the **New Slot** popup:
  - Enter a **Slot Name**.
  - Select the **Platform Type** (`Web` or `Custom`).
  - Enable the **iFrame Integration** module.
- Click **Continue**.


#### :smart-icon{name="streamline-ultimate-color:browser-com" size=45} Add the iFrame Module  

- In the **Modules** section, click `Add iFrame`.
- Select `Checkout` as the iFrame Type.
- Fill in the required fields:

| **Field**              | **Value / Description** |
|------------------------|-------------------------|
| **Target URL String**   | `eshopworld/checkout` **(default; can be changed via Magento URL Rewrite)** |
| **iFrame CSS Selector** | `.esw-checkout-iframe` **(container class where the iFrame will be created)** |
| **Fallback Cookie Name** | **(Optional but recommended)** Set a custom name, e.g., `EswCookie` to avoid conflicts. |

#### :smart-icon{name="streamline-ultimate-color:floppy-disk-2" size=45} Save the Slot  

- Click **Save** to finalize the slot configuration.


#### :smart-icon{name="streamline-ultimate-color:network-browser" size=45} Copy the Integration Snippet URL  

- After saving, copy the **Integration Snippet URL** provided.
- Use this snippet to **load and enable the Embedded Checkout iFrame** in your storefront.

::alert{type="info" icon="lucide:info"}
This setup allows the ESW checkout to be embedded within your storefront using a secure iFrame for seamless user experience.
::

### Example of the filled in fields for SFRA architecture:

- **Name:** `SFRACheckoutiFrame`
- **Target URL String:** `on/demandware.store/Sites-RefArch-Site/en_US/EShopWorld-EswEmbeddedCheckout`
- **iFrame CSS Selector:** `.esw-iframe-checkout`
- **Fallback Cookie Name:** `Checkout`

::card
---
img: /filled-in-fields.png
---
::

## Enable Embedded Checkout Feature in Business Manager

To enable the Embedded Checkout (EC) feature in Salesforce Commerce Cloud (SFCC), follow these steps:

::steps{:level="4"}

#### :smart-icon{name="streamline-ultimate-color:socket-box" size=45} Configure ESW SPARK Integration  

- Navigate to **Merchant Tools → Site Preferences → Custom Site Preferences**
- Open **ESW SPARK Integration Configuration**.
- Paste the **Integration Snippet URL** (copied from ESP) into **ESW SPARK Script Path**

::card
---
img: /1 (2).png
---
::

- Enter the **ESW SPARK Cookie Name** (used to store the checkout URL).

::card
---
img: /2.png
---
::

- Enter the **ESW SFCC OCAPI Client ID**.

::card
---
img: /3.png
---
::

- Click **Save** to apply the changes.

#### :smart-icon{name="streamline-ultimate-color:cog-hand-give-1" size=45} Update ESW Checkout Configuration  

- Go to **Merchant Tools → Site Preferences → Custom Site Preference Groups**
- Open **ESW Checkout Configuration**.
- Update the **ESW Metadata Items** with the following values:

```sh
OrderConfirmationUri_TestOnly|EShopWorld-EswEmbeddedCheckoutNotify
OrderConfirmationBase64EncodedAuth_TestOnly|1
```

::card
---
img: /esw-metadata.png
---
::

#### :smart-icon{name="streamline-ultimate-color:microchip-board" size=45} Update Cartridge Path  

- Set the cartridge path based on your **storefront architecture**:

**For PWA:**

```makefile
int_eshopworld_pwa:int_eshopworld_eckout:int_eshopworld_core:app_storefront_base:modules
```

**For SFRA:**

```makefile
int_eshopworld_sfra:int_eshopworld_eckout:int_eshopworld_core:app_storefront_base:modules
```

**For SiteGenesis (SG):**

```makefile
int_eshopworld_controllers:int_eshopworld_eckout:int_eshopworld_core:SG_controllers:SG_core:modules
```

::alert{type="info" icon="lucide:info"}
Ensure that the cartridge path is correctly set for your storefront type to enable proper ESW SPARK integration functionality.
::


## Test

Follow these steps to test

::steps{:level="4"}

#### :smart-icon{name="streamline-ultimate-color:e-commerce-apparel" size=45} Enable ESW Embedded Checkout  

- Ensure that **ESW Embedded Checkout** is enabled in the site preferences and storefront configuration.


#### :smart-icon{name="streamline-ultimate-color:e-commerce-touch-buy" size=45} Open the Storefront  

- Navigate to your **SFCC storefront** in a browser.


#### :smart-icon{name="streamline-ultimate-color:shopping-cart-add" size=45} Add a Product to the Basket  

- Browse the storefront.
- Select any product and click **Add to Basket**.


#### :smart-icon{name="streamline-ultimate-color:shopping-basket-star" size=45} Go to the Basket  

- Open the basket or mini-cart.
- Review the added product details.


#### :smart-icon{name="streamline-ultimate-color:wireless-payment-credit-card-dollar" size=45} Proceed to Checkout  

- Click the **Checkout** button.
- Verify that the **Embedded ESW Checkout** loads as expected.

::card
---
img: /embedded-checkout.png
---
::

::alert{type="success" icon="lucide:check-circle"}
This confirms that the ESW Embedded Checkout integration is functioning properly on your storefront.
::
