---
title: APIS in the Cartridge
description: Authentication is essential to ensure secure and authorized access to ESW services.
icon: 'lucide:user-lock'
toc: false
---

## Authentication API

An Authentication API call is **required** before accessing any ESW APIs such as the:

- **Pricing Advisor API**{style="color: primary"} 
- **Checkout API,**{style="color: primary"}
- **Package API**{style="color: primary"}

### OAuth-Based Authentication

- The ESW cartridge uses OAuth 2.0 to authenticate API requests.

- You must first obtain an access token by making a request to the Authentication API.

- This token is then included in the authorization header of subsequent API calls.

Proper authentication is essential to ensure secure and authorized access to ESW services.

<br>

| :smart-icon{name="lucide:server" size=20 class="dark:text-white"} **Service Name** | :smart-icon{name="lucide:file-text" size=20 class="dark:text-white"} **Description** | :smart-icon{name="lucide:code" size=20 class="dark:text-white"} **Interface** | :smart-icon{name="lucide:clock" size=20 class="dark:text-white"} **SLA** | :smart-icon{name="lucide:info" size=20 class="dark:text-white"} **Notes** |
|---|---|---|---|---|
| **esw.auth** | HTTPS Interface in JSON format | REST JSON | <ul><li>**Timeout:** 30 sec</li><li>**Circuit Breaker:** 20 calls</li><li>**Interval:** 50 sec</li></ul> | The client ID and client secret must be a part of the service configuration. |

## Basic Authentication During Order Confirmation

The ESW-SFCC cartridge uses Basic Authentication when notifying SFCC about order confirmations.

### Sandbox Configuration

For Sandbox environments, you must pass two parameters:

- `OrderConfirmationUri_TestOnly` Specifies the SFCC Notify endpoint URL for the order confirmation callback.

- `OrderConfirmationBase64EncodedAuth_TestOnly`Contains the Base64-encoded credentials (username:password) for basic authentication.
If authentication is not enabled, this parameter should be set to `1`.

Both parameters are defined under the `metadataItems` property in the `retailerCheckoutExperience` object.

```json [Example]
{
"retailerCheckoutExperience": {
   "backToCartUrl":"https://dev1.demandware.net/on/demandware.store/Sites-RefArch-Site/en_US/Cart-Show",
   "continueShoppingUrl":"https://dev1.demandware.net/on/demandware.store/Sites-RefArch-Site/en_US/Home-Show",
   "metadataItems": [
        { 
        "Name":"OrderConfirmationUri_TestOnly",
        "Value":"https://dev1.demandware.net/on/demandware.store/Sites-RefArch-Site/en_US/EShopWorld-NotifyV2"
        },
        {
        "Name":"OrderConfirmationBase64EncodedAuth_TestOnly",
        "Value":"gasxdasFSAFASGAfasfas=="
        } 
    ]
  }
}
```

::alert{type="secondary" icon="lucide:lightbulb"}
  For the Production instance, you must save the username and password details provided by ESW under the ESW General Configuration custom preference group.
::


## Pricing Advisor

The ESW-SFCC cartridge uses the Pricing Advisor service to calculate localized product prices based on various country-specific and currency-based factors.

### Price Calculation Formula

The general formula used to calculate product prices is:<br>

```java
(((Product base price × (1 + priceUpliftPercentage)) × (1 + dutyPercentage)) × (1 + taxPercentage)) × fxRate = Price in shopper currency → apply rounding = Final product price
```

## Country Pricing Models

### Calculated Price Countries

For countries where calculated pricing is enabled:

- **Shopper pays in base currency**: Only country-specific adjustments are applied to the price from the price book.
- **Shopper pays in a different currency**: Both the FX rate and country adjustments are applied to the base price.

### Fixed Price Countries

For countries with fixed pricing: 

- **Shopper pays in base currency**: No calculation is performed; the price is used as-is from the price book.

### Additional Pricing Factors

Pricing calculations may also vary based on:

1. Currency exponent

2. Rounding direction

3. Rounding model

::card
---
to: /apis/pricing-advisor-api/pricing-advisor-concepts
target: _blank
# showLinkIcon: false
icon: 'lucide:fold-horizontal'
icon-size: 28
horizontal: true
---

#title
More information on how the product prices are calculated.

#description
Full documentation on Pricing Advisor API, rounding direction, and model
::
